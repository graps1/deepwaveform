
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deep Waveform Classification and Encoding &#8212; deepwaveform 0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">deepwaveform 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Deep Waveform Classification and Encoding</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="deep-waveform-classification-and-encoding">
<h1>Deep Waveform Classification and Encoding<a class="headerlink" href="#deep-waveform-classification-and-encoding" title="Permalink to this headline">¶</a></h1>
<p>Contact: <a class="reference external" href="mailto:hans&#46;harder&#37;&#52;&#48;mailbox&#46;tu-dresden&#46;de">hans<span>&#46;</span>harder<span>&#64;</span>mailbox<span>&#46;</span>tu-dresden<span>&#46;</span>de</a></p>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="models">
<h2>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="deepwaveform.ConvNet">
<em class="property">class </em><code class="sig-prename descclassname">deepwaveform.</code><code class="sig-name descname">ConvNet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_dimension</span><span class="o">=</span><span class="default_value">64</span></em>, <em class="sig-param"><span class="n">output_dimension</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">layer1</span><span class="o">=</span><span class="default_value">5, 9</span></em>, <em class="sig-param"><span class="n">layer2</span><span class="o">=</span><span class="default_value">5, 15</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.ConvNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="deepwaveform.ConvNet.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_dimension</span><span class="o">=</span><span class="default_value">64</span></em>, <em class="sig-param"><span class="n">output_dimension</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">layer1</span><span class="o">=</span><span class="default_value">5, 9</span></em>, <em class="sig-param"><span class="n">layer2</span><span class="o">=</span><span class="default_value">5, 15</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.ConvNet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a simple one dimensional CNN with two layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dimension</strong> (<em>int</em><em>, </em><em>optional</em>) – Length of a waveform, defaults to 64</p></li>
<li><p><strong>output_dimension</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of classes, defaults to 2</p></li>
<li><p><strong>layer1</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (number kernels of first layer, kernel sizes),
defaults to (5, 9)</p></li>
<li><p><strong>layer2</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (number of kernels of second layer, kernel sizes),
defaults to (5, 15)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="deepwaveform.ConvNet.annotate_dataframe">
<code class="sig-name descname">annotate_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">wv_cols</span><span class="o">=</span><span class="default_value">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]</span></em>, <em class="sig-param"><span class="n">class_label_mapping</span><span class="o">=</span><span class="default_value">['Land', 'Water']</span></em>, <em class="sig-param"><span class="n">predicted_column</span><span class="o">=</span><span class="default_value">'Predicted'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.ConvNet.annotate_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotates a dataframe containing waveforms with the estimated
classes and respective probability estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Dataframe with waveforms</p></li>
<li><p><strong>wv_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – List of column names containing the waveforms,
defaults to list(range(64))</p></li>
<li><p><strong>class_label_mapping</strong> (<em>list</em><em>, </em><em>optional</em>) – New columns for probability estimates,
defaults to [“Land”, “Water”]</p></li>
<li><p><strong>predicted_column</strong> (<em>str</em><em>, </em><em>optional</em>) – New column for class estimates,
defaults to “Predicted”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="deepwaveform.AutoEncoder">
<em class="property">class </em><code class="sig-prename descclassname">deepwaveform.</code><code class="sig-name descname">AutoEncoder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">layer1</span><span class="o">=</span><span class="default_value">64</span></em>, <em class="sig-param"><span class="n">layer2</span><span class="o">=</span><span class="default_value">32</span></em>, <em class="sig-param"><span class="n">hidden</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.AutoEncoder" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="deepwaveform.AutoEncoder.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">layer1</span><span class="o">=</span><span class="default_value">64</span></em>, <em class="sig-param"><span class="n">layer2</span><span class="o">=</span><span class="default_value">32</span></em>, <em class="sig-param"><span class="n">hidden</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.AutoEncoder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple symmetric Autoencoder with 2 encoding layers,
one hidden and 2 decoding layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer1</strong> (<em>int</em><em>, </em><em>optional</em>) – Dimension of first/last layer, defaults to 64</p></li>
<li><p><strong>layer2</strong> (<em>int</em><em>, </em><em>optional</em>) – Dimension of second/fourth, defaults to 32</p></li>
<li><p><strong>hidden</strong> (<em>int</em><em>, </em><em>optional</em>) – Dimension of hidden layer, defaults to 5</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="deepwaveform.AutoEncoder.annotate_dataframe">
<code class="sig-name descname">annotate_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">wv_cols</span><span class="o">=</span><span class="default_value">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]</span></em>, <em class="sig-param"><span class="n">encoding_prefix</span><span class="o">=</span><span class="default_value">'hidden_'</span></em>, <em class="sig-param"><span class="n">reconstruction_prefix</span><span class="o">=</span><span class="default_value">'reconstr_'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.AutoEncoder.annotate_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotates a dataframe with the estimated encoding and
the corresponding reconstruction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Dataframe with waveforms</p></li>
<li><p><strong>wv_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – List of column names containing waveforms,
defaults to list(range(64))</p></li>
<li><p><strong>encoding_prefix</strong> (<em>str</em><em>, </em><em>optional</em>) – Prefix of new columns containing encoding,
defaults to “hidden_”</p></li>
<li><p><strong>reconstruction_prefix</strong> (<em>str</em><em>, </em><em>optional</em>) – Prefix of new columns containing
reconstruction, defaults to “reconstr_”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h2>
<dl class="py method">
<dt id="deepwaveform.preprocessing.load_dataset">
<code class="sig-prename descclassname">preprocessing.</code><code class="sig-name descname">load_dataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wv_cols</span><span class="o">=</span><span class="default_value">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]</span></em>, <em class="sig-param"><span class="n">inv_z</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.preprocessing.load_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a dataset of waveforms into a pandas dataframe. Required
columns names are id,class,x,y,z,0,…,199, where “id” marks the index,
“class” the classification (int), “x”, “y”, “z” the position of each point
and 0,…,199 the corresponding waveform. The file format is given as a
csv with seperator ” “.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – Path to file</p></li>
<li><p><strong>wv_cols</strong> (<em>List</em><em>, </em><em>optional</em>) – Column names of waveforms, defaults to list(range(64))</p></li>
<li><p><strong>inv_z</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the z-axis should be inverted, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a pandas dataframe</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="deepwaveform.preprocessing.waveform2matrix">
<code class="sig-prename descclassname">preprocessing.</code><code class="sig-name descname">waveform2matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wv_cols</span><span class="o">=</span><span class="default_value">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.preprocessing.waveform2matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a dataframe containing waveforms and returns a numpy
matrix containing the waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Dataframe containing waveforms</p></li>
<li><p><strong>wv_cols</strong> (<em>List</em><em>, </em><em>optional</em>) – Column names of waveforms, defaults to list(range(64))</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a [#samples]x[#waveform_dimension]-matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-deepwaveform.visualization">
<span id="visualization"></span><h2>Visualization<a class="headerlink" href="#module-deepwaveform.visualization" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="deepwaveform.visualization.plot_waveforms">
<code class="sig-prename descclassname">deepwaveform.visualization.</code><code class="sig-name descname">plot_waveforms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">axis</span></em>, <em class="sig-param"><span class="n">classcol</span><span class="o">=</span><span class="default_value">'class'</span></em>, <em class="sig-param"><span class="n">class_label_mapping</span><span class="o">=</span><span class="default_value">['Land', 'Water']</span></em>, <em class="sig-param"><span class="n">class_style_mapping</span><span class="o">=</span><span class="default_value">['g-', 'b--']</span></em>, <em class="sig-param"><span class="n">wv_cols</span><span class="o">=</span><span class="default_value">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.visualization.plot_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the waveforms of a dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The dataframe containing the waveforms.</p></li>
<li><p><strong>axis</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib-axis the waveforms should be plotted on</p></li>
<li><p><strong>classcol</strong> (<em>str</em><em>, </em><em>optional</em>) – Column containing class of waveform, defaults to “class”</p></li>
<li><p><strong>class_label_mapping</strong> (<em>list</em><em>, </em><em>optional</em>) – List linking class index and class names,
defaults to [“Land”, “Water”]</p></li>
<li><p><strong>class_style_mapping</strong> (<em>list</em><em>, </em><em>optional</em>) – List linking class index and waveform style,
defaults to [“g-“, “b–”]</p></li>
<li><p><strong>wv_cols</strong> (<em>List</em><em>, </em><em>optional</em>) – Columns containing waveforms, defaults to list(range(64))</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="deepwaveform.visualization.plot_pcl">
<code class="sig-prename descclassname">deepwaveform.visualization.</code><code class="sig-name descname">plot_pcl</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">axis</em>, <em class="sig-param">targetcol='class'</em>, <em class="sig-param">colormap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em>, <em class="sig-param">xcol='x'</em>, <em class="sig-param">ycol='y'</em>, <em class="sig-param">zcol='z'</em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.visualization.plot_pcl" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a pointcloud from a dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – dataframe containing points</p></li>
<li><p><strong>axis</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib-axis the pointcloud should be plotted on</p></li>
<li><p><strong>targetcol</strong> (<em>str</em><em>, </em><em>optional</em>) – Column containing class of waveform, defaults to “class”</p></li>
<li><p><strong>colormap</strong> (<em>matplotlib.colors.Colormap</em><em>, </em><em>optional</em>) – Colormap mapping class index to color,
defaults to cm.coolwarm</p></li>
<li><p><strong>xcol</strong> (<em>str</em><em>, </em><em>optional</em>) – Column containing x-position, defaults to “x”</p></li>
<li><p><strong>ycol</strong> (<em>str</em><em>, </em><em>optional</em>) – Column containing y-position, defaults to “y”</p></li>
<li><p><strong>zcol</strong> (<em>str</em><em>, </em><em>optional</em>) – Column containing z-position, defaults to “z”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="deepwaveform.visualization.plot_pcl_prediction">
<code class="sig-prename descclassname">deepwaveform.visualization.</code><code class="sig-name descname">plot_pcl_prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">axis</span></em>, <em class="sig-param"><span class="n">probabilities_col</span><span class="o">=</span><span class="default_value">['Land', 'Water']</span></em>, <em class="sig-param"><span class="n">colors</span><span class="o">=</span><span class="default_value">['green', 'blue']</span></em>, <em class="sig-param"><span class="n">xcol</span><span class="o">=</span><span class="default_value">'x'</span></em>, <em class="sig-param"><span class="n">ycol</span><span class="o">=</span><span class="default_value">'y'</span></em>, <em class="sig-param"><span class="n">zcol</span><span class="o">=</span><span class="default_value">'z'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.visualization.plot_pcl_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the pointcloud of a dataframe with interpolated coloring,
dependent on probability estimates of corresponding classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – dataframe containing points and probability estimates.</p></li>
<li><p><strong>axis</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib-axis the pointcloud should be plotted on</p></li>
<li><p><strong>probabilities_col</strong> (<em>list</em><em>, </em><em>optional</em>) – Columns with probability estimates,
defaults to [“Land”, “Water”]</p></li>
<li><p><strong>colors</strong> (<em>list</em><em>, </em><em>optional</em>) – Colors associates with probability estimates,
defaults to [“green”, “blue”]</p></li>
<li><p><strong>xcol</strong> (<em>str</em><em>, </em><em>optional</em>) – Column containing x-position, defaults to “x”</p></li>
<li><p><strong>ycol</strong> (<em>str</em><em>, </em><em>optional</em>) – Column containing y-position, defaults to “y”</p></li>
<li><p><strong>zcol</strong> (<em>str</em><em>, </em><em>optional</em>) – Column containing z-position, defaults to “z”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="deepwaveform.visualization.plot_training_progress">
<code class="sig-prename descclassname">deepwaveform.visualization.</code><code class="sig-name descname">plot_training_progress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stats</span></em>, <em class="sig-param"><span class="n">axis</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.visualization.plot_training_progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the training process of a network over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<em>List</em><em>[</em><em>Dict</em><em>]</em>) – List of dictionaries, containing entries for
“meanloss” and “varloss”.</p></li>
<li><p><strong>axis</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib-axis the training process should be
plotted on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="deepwaveform.visualization.plot_confusion_matrix">
<code class="sig-prename descclassname">deepwaveform.visualization.</code><code class="sig-name descname">plot_confusion_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">axis</span></em>, <em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">class_label_mapping</span><span class="o">=</span><span class="default_value">['Land', 'Water']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.visualization.plot_confusion_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the confusion matrix of a classifier w.r.t. a dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#deepwaveform.ConvNet" title="deepwaveform.ConvNet"><em>deepwaveform.ConvNet</em></a>) – The classifier</p></li>
<li><p><strong>axis</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib-axis the confusion matrix should be plotted on</p></li>
<li><p><strong>dataset</strong> (<a class="reference internal" href="#deepwaveform.WaveFormDataset" title="deepwaveform.WaveFormDataset"><em>deepwaveform.WaveFormDataset</em></a>) – The dataset</p></li>
<li><p><strong>class_label_mapping</strong> (<em>list</em><em>, </em><em>optional</em>) – List linking class indices to class names,
defaults to [“Land”, “Water”]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="dataset-and-training">
<h2>Dataset and Training<a class="headerlink" href="#dataset-and-training" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="deepwaveform.WaveFormDataset">
<em class="property">class </em><code class="sig-prename descclassname">deepwaveform.</code><code class="sig-name descname">WaveFormDataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">classcol</span><span class="o">=</span><span class="default_value">'class'</span></em>, <em class="sig-param"><span class="n">wv_cols</span><span class="o">=</span><span class="default_value">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.WaveFormDataset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="deepwaveform.WaveFormDataset.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">classcol</span><span class="o">=</span><span class="default_value">'class'</span></em>, <em class="sig-param"><span class="n">wv_cols</span><span class="o">=</span><span class="default_value">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.WaveFormDataset.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a dataset that can be processed by neural networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The dataframe containing the waveforms</p></li>
<li><p><strong>classcol</strong> (<em>str</em><em>, </em><em>optional</em>) – Column in dataframe containing class of waveform.
If <cite>None</cite> then class of waveform is ignored – e.g. when it comes
to autoencoders, defaults to “class”</p></li>
<li><p><strong>wv_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – Columns dataframe containing waveforms,
defaults to list(range(64))</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="deepwaveform.Trainer">
<em class="property">class </em><code class="sig-prename descclassname">deepwaveform.</code><code class="sig-name descname">Trainer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">epochs</span><span class="o">=</span><span class="default_value">20</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="deepwaveform.Trainer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">epochs</span><span class="o">=</span><span class="default_value">20</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.Trainer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a trainer for a neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#deepwaveform.ConvNet" title="deepwaveform.ConvNet"><em>deepwaveform.ConvNet</em></a><em> or </em><a class="reference internal" href="#deepwaveform.AutoEncoder" title="deepwaveform.AutoEncoder"><em>deepwaveform.AutoEncoder</em></a>) – The model</p></li>
<li><p><strong>dataset</strong> (<a class="reference internal" href="#deepwaveform.WaveFormDataset" title="deepwaveform.WaveFormDataset"><em>deepwaveform.WaveFormDataset</em></a>) – The dataset the model should be trained on</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em><em>, </em><em>optional</em>) – The optimizer that should be used. If None,
then Adam is used, defaults to None</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The batch size used for training, defaults to 128</p></li>
<li><p><strong>epochs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of epochs used for training, defaults to 20</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="deepwaveform.Trainer.train_classifier">
<code class="sig-name descname">train_classifier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.Trainer.train_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a classifier over the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An iterator over the results of each epoch. Each
result is given as a dictionary with keys “meanloss”
and “varloss”</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Iterator[Dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="deepwaveform.Trainer.train_autoencoder">
<code class="sig-name descname">train_autoencoder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sparsity</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepwaveform.Trainer.train_autoencoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains an autoencoder over the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sparsity</strong> (<em>int</em><em>, </em><em>optional</em>) – multiplier for l1 penalty on the hidden layer,
defaults to 0</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An iterator over the results of each epoch. Each
result is given as a dictionary with keys “meanloss”
and “varloss”</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Iterator[Dict]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Deep Waveform Classification and Encoding</a><ul>
<li><a class="reference internal" href="#models">Models</a></li>
<li><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li><a class="reference internal" href="#module-deepwaveform.visualization">Visualization</a></li>
<li><a class="reference internal" href="#dataset-and-training">Dataset and Training</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">deepwaveform 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Deep Waveform Classification and Encoding</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Hans Harder.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>